module Ruconomic
  module API
    extend Ruconomic::WebService

    # Connects to the server.
    #
    # @see https://api.e-conomic.com/secure/api1/EconomicWebService.asmx?op=Connect
    # @param agreement [String] The agreement number for the subscription.
    # @param username [String] The user name of the subscription.
    # @param password [String] The password for the user name.
    # @return [String] The token for this connection
    def self.connect(agreement, username, password)
      response = invoke('Connect') do |message|
        message.add 'agreementNumber', agreement
        message.add 'userName', username
        message.add 'password', password
      end

      response.find('//dns:ConnectResult/text()').first.to_s
    end

    # Connects to the server.
    # Parameters: agreementNumber: The agreement number for the subscription. userName: The user name of the subscription. password: The password for the user name.
    #
    # @note TODO: This method was autogenerated from the WSDL - see https://github.com/ta/e-conomic#contributing"
    # @see https://api.e-conomic.com/secure/api1/EconomicWebService.asmx?op=ConnectAsAdministrator
    # @return [Hash] The body content of the SOAP response.
    def self.connect_as_administrator
      response = invoke('ConnectAsAdministrator') do |message|
        raise "TODO: This method was autogenerated from the WSDL - see https://github.com/ta/e-conomic#contributing"
      end
    end

    # Connects to the server.
    # Parameters: agreementNumber: The agreement number for the subscription. userName: The user name of the subscription. password: The password for the user name. customerNumber: the internal adminCustomerNumber
    #
    # @note TODO: This method was autogenerated from the WSDL - see https://github.com/ta/e-conomic#contributing"
    # @see https://api.e-conomic.com/secure/api1/EconomicWebService.asmx?op=ConnectAsAdministratorWithCustomerNumber
    # @return [Hash] The body content of the SOAP response.
    def self.connect_as_administrator_with_customer_number
      response = invoke('ConnectAsAdministratorWithCustomerNumber') do |message|
        raise "TODO: This method was autogenerated from the WSDL - see https://github.com/ta/e-conomic#contributing"
      end
    end

    # Connects to the server.
    # Parameters: token: The access token provided. 
    #
    # @note TODO: This method was autogenerated from the WSDL - see https://github.com/ta/e-conomic#contributing"
    # @see https://api.e-conomic.com/secure/api1/EconomicWebService.asmx?op=ConnectWithToken
    # @return [Hash] The body content of the SOAP response.
    def self.connect_with_token
      response = invoke('ConnectWithToken') do |message|
        raise "TODO: This method was autogenerated from the WSDL - see https://github.com/ta/e-conomic#contributing"
      end
    end

    # Disconnects from the server.
    #
    # @see https://api.e-conomic.com/secure/api1/EconomicWebService.asmx?op=Disconnect
    # @return [String] The result of the disconnect operation
    def self.disconnect
      response = invoke('Disconnect')
      
      response.find('//dns:DisconnectResult/text()').first.to_s
    end

    # Gets information about the e-conomic API.
    #
    # @see https://api.e-conomic.com/secure/api1/EconomicWebService.asmx?op=GetApiInformation
    # @return [String] The API version
    def self.get_api_information
      response = invoke('GetApiInformation')
      
      response.find('//dns:GetApiInformationResult/text()').first.to_s
    end
      
  end
end
